<!DOCTYPE html>
<html lang="de">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Thorstens Umfragen</title>
    <link rel="shortcut icon" href="icon.webp" type="image/x-icon">
    <script type="module" src="https://cdn.jsdelivr.net/npm/emoji-picker-element@^1/index.js"></script>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <nav>
        <a id="overviewTabButton" class="tabButton" onclick="onTabSelect('overview');">👀 Umfrageansicht</a>
        <a id="statisticsTabButton" class="tabButton" onclick="onTabSelect('statistics');">📊 Umfragestatistiken</a>
        <a id="archiveSurveyTabButton" class="tabButton" onclick="onTabSelect('archiveSurvey');">✒️ Umfrage eintragen</a>
        <a id="createSurveyTabButton" class="tabButton" onclick="onTabSelect('createSurvey');">✨ Umfrage erstellen (Ohne AI)</a>
    </nav>

    <div id="greetingScreen"></div>
    <div id="overviewTab" class="tab"></div>
    <div id="statisticsTab" class="tab"></div>
    <div id="archiveSurveyTab" class="tab"></div>
    <div id="createSurveyTab" class="tab"></div>


</body>
</html>



<script>
//speichervorgang:
//bei knopfdruck onklick für speichern ausführen
//alle vorhandenen inputs auslesen und daten in classe oder ass. array speichern
//aus classe oder ass. array in datei fetchen

// remove old temporary scripts and load new ones
function loadScript(url) {
    //alert("adding " + url);
    const script = document.createElement('script');
    script.src = url;
    script.onload = () => init();
    script.className = "tabScript";
    document.head.appendChild(script);
}

function loadHTML(url, elementId, scriptUrl) {
    fetch(url)
        .then(response => response.text())
        .then(data => {
            document.getElementById(elementId).innerHTML = data;
            if (scriptUrl != undefined) loadScript(scriptUrl);
        })
        .catch(error => console.error('Fehler beim Laden des HTML-Fragments:', error));
}

// tab switching
function onTabSelect(selectedTabId) {
    //remove greetingscreen if present
    document.getElementById("greetingScreen")?.remove();

    // unload and load tab
    document.querySelectorAll(".tabScript").forEach(script => script.remove());
    document.querySelectorAll(".tabContent").forEach(script => script.remove());

    document.querySelectorAll('.tab').forEach(element => {
        element.innerHTML = "";
    });
    loadHTML("tabs/"+ selectedTabId + ".html", selectedTabId + "Tab", "scripts/" + selectedTabId + ".js");

    //update nav button highlight
    document.querySelectorAll('.tabButton').forEach(element => {
        element.classList.remove("selected")
    });
    document.getElementById(selectedTabId + "TabButton").classList.add("selected");
}

// maybe i should just remove this function
function insertTemlate(parent, template) {
    const newContainer = template.content.cloneNode(true);
    parent.appendChild(newContainer);
}

function getCurrentTimeFormatted() {
        const now = new Date();
    
        const day = String(now.getDate()).padStart(2, '0');
        const month = String(now.getMonth() + 1).padStart(2, '0'); // Monate sind 0-basiert
        const year = now.getFullYear();
    
        const hours = String(now.getHours()).padStart(2, '0');
        const minutes = String(now.getMinutes()).padStart(2, '0');
    
        return `${day}.${month}.${year} ${hours}:${minutes}`;
    }

// initialize greeting screen
loadHTML("tabs/greetingScreen.html", "greetingScreen")

</script>
